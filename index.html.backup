<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no,minimal-ui,viewport-fit=cover,shrink-to-fit=no">
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-touch-fullscreen" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
	<meta name="mobile-web-app-orientation" content="landscape">
	<meta name="screen-orientation" content="landscape">
	<meta name="x5-orientation" content="landscape">
	<meta name="x5-fullscreen" content="true">
	<meta name="360-fullscreen" content="true">
	<meta name="full-screen" content="yes">
	<meta name="format-detection" content="telephone=no">
	<meta name="msapplication-tap-highlight" content="no">
	<title> å°çƒæ¸¸æˆ | ç§»åŠ¨ç«¯ä¼˜åŒ–ç‰ˆ </title>
	<meta name="description" content="å°çƒæ¸¸æˆ - ç§»åŠ¨ç«¯ä¼˜åŒ–ç‰ˆ">
	<meta name="keywords" content="å°çƒ,8çƒ,ä½“è‚²æ¸¸æˆ,æ‰‹æœºæ¸¸æˆ">
	<style type="text/css">
		body{margin:0;padding:0;font-size:12px;background:url(res/wood.jpg); touch-action: manipulation; overflow: hidden;}

/* åŸºç¡€å®¹å™¨æ ·å¼ */
#container {
    width: 100vw;
    height: 100vh;
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    margin: 0;
    padding: 0;
}

/* æ¸¸æˆç”»å¸ƒè‡ªé€‚åº” */
#container canvas {
    max-width: none !important;
    max-height: none !important;
    width: auto !important;
    height: auto !important;
    object-fit: contain;
    display: block;
    touch-action: manipulation;
    margin: auto;
}

/* æ¨ªå±æ¨¡å¼æ ·å¼ */
@media (orientation: landscape) {
    #container {
        width: 100vw;
        height: 100vh;
        position: absolute;
        top: 0;
        left: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        background-size: cover;
        background-position: center;
    }
    
    /* æ¸¸æˆç”»å¸ƒé€‚é… */
    #container canvas {
        max-width: none !important;
        max-height: none !important;
        width: auto !important;
        height: auto !important;
        object-fit: contain;
        display: block;
        margin: auto;
    }
    
    .virtual-controls {
        display: flex !important;
        flex-direction: column;
        right: 1vw;
        left: auto;
        bottom: 2vh;
        top: auto;
        align-items: center;
        justify-content: flex-end;
        gap: 2vh;
        background: rgba(0, 0, 0, 0.3);
        transform-origin: bottom right;
        padding: 2vh 1vw;
        border-radius: 20px;
        border: 2px solid rgba(255, 255, 255, 0.2);
    }
    
    .virtual-controls .control-button {
        width: min(10vw, 8vh, 70px);
        height: min(10vw, 8vh, 70px);
        font-size: min(5vw, 4vh, 24px);
        margin: 0.5vh 0;
        background: rgba(255, 255, 255, 0.4);
        border: 3px solid rgba(255, 255, 255, 0.8);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
    }
    
    .virtual-controls .control-button.special {
        width: min(12vw, 10vh, 80px);
        height: min(12vw, 10vh, 80px);
        font-size: min(6vw, 5vh, 28px);
        background: rgba(255, 215, 0, 0.4);
        border-color: rgba(255, 215, 0, 0.9);
    }
    
    .game-status {
        top: 2vh;
        left: 2vw;
        right: auto;
        bottom: auto;
        max-width: 35vw;
    }
}

/* ç«–å±æ¨¡å¼æ ·å¼ */
@media (orientation: portrait) {
    #container {
        width: 100vw;
        height: 100vh;
        position: absolute;
        top: 0;
        left: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        background-size: cover;
        background-position: center;
    }
    
    /* ç«–å±æ¨¡å¼ä¸‹çš„æ¸¸æˆç”»å¸ƒ */
    #container canvas {
        max-width: 88vw !important;
        max-height: 50vh !important;
        width: auto !important;
        height: auto !important;
        object-fit: contain;
        display: block;
        margin: 2vh auto;
    }
    
    .virtual-controls {
        display: flex !important;
        flex-direction: row;
        left: 50%;
        right: auto;
        bottom: 2vh;
        top: auto;
        transform: translateX(-50%);
        align-items: center;
        justify-content: center;
        gap: 3vw;
        background: rgba(0, 0, 0, 0.3);
        transform-origin: bottom center;
        padding: 2vh 4vw;
        border-radius: 25px;
        border: 2px solid rgba(255, 255, 255, 0.2);
        max-width: 90vw;
    }
    
    .virtual-controls .control-button {
        width: min(15vw, 15vh, 80px);
        height: min(15vw, 15vh, 80px);
        font-size: min(7vw, 7vh, 28px);
        margin: 0 1vw;
        background: rgba(255, 255, 255, 0.4);
        border: 3px solid rgba(255, 255, 255, 0.8);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
    }
    
    .virtual-controls .control-button.special {
        width: min(18vw, 18vh, 90px);
        height: min(18vw, 18vh, 90px);
        font-size: min(8vw, 8vh, 32px);
        background: rgba(255, 215, 0, 0.4);
        border-color: rgba(255, 215, 0, 0.9);
    }
    
    .game-status {
        top: 1vh;
        left: 2vw;
        right: 2vw;
        bottom: auto;
        max-width: none;
        text-align: center;
        font-size: min(4vw, 3vh, 18px);
        padding: 1.5vh 2vw;
    }
    
    .game-status div {
        display: inline-block;
        margin: 0 2vw;
        white-space: nowrap;
    }
    
    /* éšè—ç«–å±è­¦å‘Š */
    .portrait-warning {
        display: none !important;
    }
}

/* ç«–å±æ¨¡å¼æç¤º */
.portrait-warning {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.95);
    color: white;
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    z-index: 9999;
    padding: 20px;
    animation: fadeIn 0.3s ease;
}

.portrait-warning.visible {
    display: flex;
}

.portrait-warning-icon {
    font-size: 64px;
    margin-bottom: 30px;
    animation: rotate 2s ease-in-out infinite;
}

.portrait-warning-text {
    font-size: 20px;
    line-height: 1.6;
    max-width: 300px;
    margin-bottom: 30px;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes rotate {
    0%, 100% { transform: rotate(0deg); }
    50% { transform: rotate(90deg); }
}
		
		/* ç§»åŠ¨ç«¯è™šæ‹Ÿæ§åˆ¶å™¨ */
	.virtual-controls {
		display: none;
		position: fixed;
		right: 2vw;
		bottom: 2vh;
		flex-direction: column;
		gap: 1.5vh;
		z-index: 1001;
		padding: 1.5vh 1.5vw;
		background: rgba(0, 0, 0, 0.1);
		border-radius: 15px;
		backdrop-filter: blur(10px);
		border: 1px solid rgba(255, 255, 255, 0.1);
		/* è‡ªåŠ¨ç¼©æ”¾æ§åˆ¶ */
		transform: scale(1);
		transform-origin: bottom right;
	}

	.virtual-controls .control-button {
		/* ä½¿ç”¨è§†å£å•ä½å®ç°è‡ªåŠ¨ç¼©æ”¾ */
		width: min(8vw, 8vh, 60px);
		height: min(8vw, 8vh, 60px);
		background: rgba(255, 255, 255, 0.3);
		border: 2px solid rgba(255, 255, 255, 0.6);
		border-radius: 50%;
		color: white;
		font-size: min(4vw, 4vh, 20px);
		cursor: pointer;
		display: flex;
		align-items: center;
		justify-content: center;
		backdrop-filter: blur(10px);
		transition: all 0.2s ease;
		box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
		position: relative;
		overflow: hidden;
		touch-action: manipulation;
		-webkit-tap-highlight-color: transparent;
	}

		.virtual-controls .control-button::before {
			content: '';
			position: absolute;
			top: 50%;
			left: 50%;
			width: 0;
			height: 0;
			background: rgba(255, 255, 255, 0.3);
			border-radius: 50%;
			transform: translate(-50%, -50%);
			transition: all 0.3s ease;
		}

		.virtual-controls .control-button:active::before {
			width: 100%;
			height: 100%;
		}

		.virtual-controls .control-button.active {
			background: rgba(255, 255, 255, 0.4);
			transform: scale(0.95);
		}

		.virtual-controls .control-button.special {
			width: min(10vw, 10vh, 80px);
			height: min(10vw, 10vh, 80px);
			background: rgba(255, 215, 0, 0.3);
			border-color: rgba(255, 215, 0, 0.7);
			font-size: min(5vw, 5vh, 24px);
		}

		/* åŠ›åº¦æ˜¾ç¤º */
		.power-indicator {
			position: absolute;
			top: -8px;
			right: -8px;
			width: min(5vw, 5vh, 20px);
			height: min(5vw, 5vh, 20px);
			background: rgba(255, 69, 0, 0.8);
			border-radius: 50%;
			display: none;
			align-items: center;
			justify-content: center;
			font-size: min(2.5vw, 2.5vh, 10px);
			color: white;
			font-weight: bold;
		}

		.power-indicator.visible {
			display: flex;
			animation: pulse 0.5s ease-in-out infinite alternate;
		}

		@keyframes pulse {
			from { transform: scale(1); }
			to { transform: scale(1.2); }
		}

		/* æ¸¸æˆçŠ¶æ€æ˜¾ç¤º - è‡ªåŠ¨ç¼©æ”¾é€‚é… */
		.game-status {
			position: fixed;
			top: 2vh;
			left: 2vw;
			z-index: 1000;
			color: white;
			font-size: min(3.5vw, 2vh, 16px);
			font-weight: bold;
			text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
			background: rgba(0, 0, 0, 0.6);
			padding: 2vh 2vw;
			border-radius: 15px;
			backdrop-filter: blur(10px);
			line-height: 1.5;
			display: none;
			min-width: min(35vw, 140px);
			border: 2px solid rgba(255, 255, 255, 0.2);
			box-shadow: 0 6px 16px rgba(0, 0, 0, 0.5);
			transform: scale(1);
			transform-origin: top left;
		}

		.game-status div {
			margin: 0.5vh 0;
			white-space: nowrap;
		}

		.game-status span {
			color: #4CAF50;
			font-weight: bold;
		}

		/* ç§»åŠ¨ç«¯ç‰¹æ®Šé€‚é… */
		@media screen and (max-width: 768px) {
			.virtual-controls {
				display: flex;
			}
			
			.game-status {
				display: block;
			}
			
			.orientation-indicator {
				display: block;
			}
			
			/* é˜²æ­¢é¡µé¢æ»šåŠ¨ */
			html, body {
				overflow: hidden;
				position: fixed;
				width: 100%;
				height: 100%;
			}
		}

		/* æ–¹å‘æŒ‡ç¤ºå™¨ */
		.orientation-indicator {
			position: fixed;
			top: 2vh;
			right: 2vw;
			z-index: 1000;
			background: rgba(0, 0, 0, 0.6);
			color: white;
			padding: 1vh 2vw;
			border-radius: 10px;
			font-size: min(3vw, 2vh, 14px);
			display: none;
			align-items: center;
			gap: 1vw;
			backdrop-filter: blur(10px);
			border: 1px solid rgba(255, 255, 255, 0.2);
			transition: all 0.3s ease;
		}

		.orientation-indicator span {
			white-space: nowrap;
		}

		/* æ¨ªå±æ¨¡å¼ä¸‹çš„æ–¹å‘æŒ‡ç¤ºå™¨ */
		@media (orientation: landscape) {
			.orientation-indicator {
				top: 2vh;
				right: 15vw; /* é¿å¼€æ§åˆ¶æŒ‰é’® */
			}
		}

		/* ç«–å±æ¨¡å¼ä¸‹çš„æ–¹å‘æŒ‡ç¤ºå™¨ */
		@media (orientation: portrait) {
			.orientation-indicator {
				top: 8vh; /* é¿å¼€æ¸¸æˆçŠ¶æ€æ  */
				right: 2vw;
			}
		}

		/* å°å±å¹•è®¾å¤‡ä¼˜åŒ– */
		@media screen and (max-width: 480px) {
			.virtual-controls .control-button {
				width: min(12vw, 50px);
				height: min(12vw, 50px);
				font-size: min(6vw, 18px);
			}
			
			.virtual-controls .control-button.special {
				width: min(15vw, 65px);
				height: min(15vw, 65px);
				font-size: min(7vw, 22px);
			}
		}
	</style>
</head>
<body>
	<div id = "container"></div>
<div id = "fps" style = "position:absolute"></div>

<!-- å¯é€‰çš„æ¨ªå±æç¤º (ç°åœ¨æ”¯æŒä¸¤ç§æ–¹å‘ï¼Œå¯ä»¥éšè—æ­¤æç¤º) -->
<div class="portrait-warning" id="portraitWarning" style="display: none;">
    <div class="portrait-warning-icon">ğŸ“±</div>
    <div class="portrait-warning-text">
        æ¸¸æˆç°åœ¨æ”¯æŒæ¨ªå±å’Œç«–å±æ¨¡å¼<br>
        æ¨ªå±æ¨¡å¼å¯è·å¾—æ›´ä½³ä½“éªŒ
        <br><br>
        <button onclick="orientationManager.hideWarning()" style="background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
            ç»§ç»­æ¸¸æˆ
        </button>
    </div>
</div>
	
	<!-- ç§»åŠ¨ç«¯è™šæ‹Ÿæ§åˆ¶å™¨ -->
	<div class="virtual-controls" id="virtualControls">
		<button class="control-button" id="powerBtn" title="åŠ›åº¦">
			âš¡
			<div class="power-indicator" id="powerIndicator">0</div>
		</button>
		<button class="control-button special" id="shootBtn" title="å‡»çƒ">ğŸ±</button>
		<button class="control-button" id="resetBtn" title="é‡æ–°å¼€å§‹">ğŸ”„</button>
	</div>

	<!-- æ¸¸æˆçŠ¶æ€æ˜¾ç¤º -->
	<div class="game-status" id="gameStatus">
		<div>ğŸ± å°çƒæ¸¸æˆ</div>
		<div>å¾—åˆ†: <span id="scoreDisplay">0</span></div>
		<div>çƒæ•°: <span id="ballsDisplay">7</span></div>
		<div>çŠ¶æ€: <span id="gameState">å‡†å¤‡å¼€å§‹</span></div>
	</div>

	<!-- æ–¹å‘æŒ‡ç¤ºå™¨ -->
	<div class="orientation-indicator" id="orientationIndicator">
		<span id="orientationIcon">ğŸ“±</span>
		<span id="orientationText">ç«–å±æ¨¡å¼</span>
	</div>

	<script src = "src/quark.base-1.0.0.alpha.min.js"></script>
	<script src = "Taiqiu.js"></script>
	<script src = "mobile-adaptation.js"></script>
	<!-- ç®€åŒ–çš„å…¨å±åŠŸèƒ½å®ç° -->
	<script>
		window.FullscreenUtils = {
			initFullscreen: function(containerId, gameTitle) {
				console.log('å…¨å±åŠŸèƒ½åˆå§‹åŒ– - ' + gameTitle);
			}
		};
		
		// æ–¹å‘ç®¡ç†å™¨
		window.orientationManager = {
			init: function() {
				this.checkOrientation();
				window.addEventListener('orientationchange', () => {
					setTimeout(() => this.checkOrientation(), 100);
				});
				window.addEventListener('resize', () => {
					setTimeout(() => this.checkOrientation(), 100);
				});
			},
			
			checkOrientation: function() {
				const isPortrait = window.innerHeight > window.innerWidth;
				const warning = document.getElementById('portraitWarning');
				
				// ä¸å†æ˜¾ç¤ºç«–å±è­¦å‘Šï¼Œå› ä¸ºç°åœ¨æ”¯æŒä¸¤ç§æ–¹å‘
				this.hideWarning();
				
				// æ ¹æ®æ–¹å‘è°ƒæ•´æ¸¸æˆç•Œé¢
				this.adaptToOrientation(isPortrait);
			},
			
			adaptToOrientation: function(isPortrait) {
				const virtualControls = document.getElementById('virtualControls');
				const gameStatus = document.getElementById('gameStatus');
				const orientationIndicator = document.getElementById('orientationIndicator');
				const orientationIcon = document.getElementById('orientationIcon');
				const orientationText = document.getElementById('orientationText');
				
				if (virtualControls && this.isMobileDevice()) {
					virtualControls.style.display = 'flex';
				}
				
				if (gameStatus && this.isMobileDevice()) {
					gameStatus.style.display = 'block';
				}
				
				// æ›´æ–°æ–¹å‘æŒ‡ç¤ºå™¨
				if (orientationIndicator && this.isMobileDevice()) {
					orientationIndicator.style.display = 'flex';
					if (orientationIcon && orientationText) {
						if (isPortrait) {
							orientationIcon.textContent = 'ğŸ“±';
							orientationText.textContent = 'ç«–å±æ¨¡å¼';
						} else {
							orientationIcon.textContent = 'ğŸ–¥ï¸';
							orientationText.textContent = 'æ¨ªå±æ¨¡å¼';
						}
					}
				}
				
				// è§¦å‘æ¸¸æˆç”»å¸ƒé‡æ–°è°ƒæ•´
				if (window.BallGame && BallGame.stage && BallGame.stage.canvas) {
					setTimeout(() => {
						this.resizeGameCanvas();
					}, 200);
				}
			},
			
			resizeGameCanvas: function() {
				if (window.BallGame && BallGame.stage && BallGame.stage.canvas) {
					const canvas = BallGame.stage.canvas;
					const container = document.getElementById('container');
					
					if (container && canvas) {
						const containerRect = container.getBoundingClientRect();
						const isPortrait = window.innerHeight > window.innerWidth;
						const originalWidth = 960;
						const originalHeight = 600;
						const aspectRatio = originalWidth / originalHeight;
						
						let availableWidth, availableHeight;
						
						if (isPortrait) {
							// ç«–å±æ¨¡å¼ï¼šä¸ºUIå…ƒç´ é¢„ç•™æ›´å¤šç©ºé—´ï¼Œç¡®ä¿å®Œæ•´æ˜¾ç¤º
							availableHeight = containerRect.height * 0.45; // 45%
							availableWidth = containerRect.width * 0.90; // 90%å®½åº¦
						} else {
							// æ¨ªå±æ¨¡å¼ï¼šä¸ºæ§åˆ¶æŒ‰é’®é¢„ç•™ç©ºé—´
							availableWidth = containerRect.width * 0.75; // 75%
							availableHeight = containerRect.height * 0.85; // 85%é«˜åº¦
						}
						
						let newWidth, newHeight;
						
						// è®¡ç®—åˆé€‚çš„å°ºå¯¸ï¼Œç¡®ä¿å®Œæ•´æ˜¾ç¤º
						if (availableWidth / availableHeight > aspectRatio) {
							// ä»¥é«˜åº¦ä¸ºå‡†
							newHeight = availableHeight;
							newWidth = newHeight * aspectRatio;
						} else {
							// ä»¥å®½åº¦ä¸ºå‡†
							newWidth = availableWidth;
							newHeight = newWidth / aspectRatio;
						}
						
						// ç¡®ä¿æœ€å°å°ºå¯¸
						const minWidth = 320;
						const minHeight = 200;
						
						if (newWidth < minWidth) {
							newWidth = minWidth;
							newHeight = newWidth / aspectRatio;
						}
						if (newHeight < minHeight) {
							newHeight = minHeight;
							newWidth = newHeight * aspectRatio;
						}
						
						// è®¡ç®—ç¼©æ”¾æ¯”ä¾‹
						const scale = Math.min(newWidth / originalWidth, newHeight / originalHeight);
						
						// è®¾ç½®canvasæ˜¾ç¤ºå°ºå¯¸
						const finalWidth = originalWidth * scale;
						const finalHeight = originalHeight * scale;
						
						canvas.style.width = finalWidth + 'px';
						canvas.style.height = finalHeight + 'px';
						
						// ä¿æŒåŸå§‹canvaså°ºå¯¸ï¼Œä½¿ç”¨CSSç¼©æ”¾
						canvas.width = originalWidth;
						canvas.height = originalHeight;
						canvas.style.transform = `scale(${scale})`;
						canvas.style.transformOrigin = 'center center';
						
						// ç¡®ä¿ç”»å¸ƒå±…ä¸­æ˜¾ç¤º
						canvas.style.margin = 'auto';
						canvas.style.display = 'block';
						
						// æ›´æ–°èˆå°å°ºå¯¸ä½†ä¿æŒåŸå§‹é€»è¾‘åæ ‡
						if (BallGame.stage) {
							BallGame.stage.width = originalWidth;
							BallGame.stage.height = originalHeight;
							BallGame.stage.scaleX = scale;
							BallGame.stage.scaleY = scale;
						}
						
						console.log(`ç”»å¸ƒè°ƒæ•´: ${finalWidth}x${finalHeight} (ç¼©æ”¾: ${scale.toFixed(3)}, ${isPortrait ? 'ç«–å±' : 'æ¨ªå±'})`);
					}
				}
			},
			
			showWarning: function() {
				// ä¸å†æ˜¾ç¤ºè­¦å‘Šï¼Œå› ä¸ºç°åœ¨æ”¯æŒæ‰€æœ‰æ–¹å‘
			},
			
			hideWarning: function() {
				const warning = document.getElementById('portraitWarning');
				if (warning) {
					warning.classList.remove('visible');
				}
			},
			
			isMobileDevice: function() {
				return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|Tablet/i.test(navigator.userAgent) || 
					   (window.innerWidth < 768 && 'ontouchstart' in window);
			}
		};
		
		// åˆå§‹åŒ–æ–¹å‘ç®¡ç†å™¨
		document.addEventListener('DOMContentLoaded', function() {
			orientationManager.init();
		});
	</script>
	
	<!-- ç§»åŠ¨ç«¯ä¼˜åŒ–è„šæœ¬ -->
	<script>
		// ç®€åŒ–çš„ç§»åŠ¨è®¾å¤‡æ£€æµ‹
		function isMobileDevice() {
			return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|Tablet/i.test(navigator.userAgent) || 
				   (window.innerWidth < 768 && 'ontouchstart' in window);
		}
		
		// åˆå§‹åŒ–è™šæ‹Ÿæ§åˆ¶å™¨
		function initVirtualControls() {
			const shootBtn = document.getElementById('shootBtn');
			const resetBtn = document.getElementById('resetBtn');
			
			// å‡»çƒæŒ‰é’®
			shootBtn.addEventListener('touchstart', function(e) {
				e.preventDefault();
				if (window.BallGame && BallGame.canShot && !BallGame.paused) {
					// ä½¿ç”¨æ™ºèƒ½å‡»çƒåŠŸèƒ½
					if (BallGame.smartShoot) {
						BallGame.smartShoot();
					}
				}
			});
			shootBtn.addEventListener('click', function(e) {
				e.preventDefault();
				if (window.BallGame && BallGame.canShot && !BallGame.paused) {
					if (BallGame.smartShoot) {
						BallGame.smartShoot();
					}
				}
			});
			
			// é‡æ–°å¼€å§‹æŒ‰é’®
			resetBtn.addEventListener('touchstart', function(e) {
				e.preventDefault();
				if (window.BallGame && BallGame.reset) {
					BallGame.reset();
				}
			});
			resetBtn.addEventListener('click', function(e) {
				e.preventDefault();
				if (window.BallGame && BallGame.reset) {
					BallGame.reset();
				}
			});
		}
		
		// æ¸¸æˆåˆå§‹åŒ–å‡½æ•°
		function initGameUI() {
			try {
				// ç­‰å¾…BallGameå¯¹è±¡å®Œå…¨åˆå§‹åŒ–
				const checkBallGame = setInterval(() => {
					if (window.BallGame && BallGame.stage) {
						clearInterval(checkBallGame);
						console.log('BallGameå¯¹è±¡å·²åˆå§‹åŒ–ï¼Œå¼€å§‹åˆå§‹åŒ–UI');
						
						// åˆå§‹åŒ–è™šæ‹Ÿæ§åˆ¶å™¨
						initVirtualControls();
						
						// å¦‚æœæ˜¯ç§»åŠ¨è®¾å¤‡ï¼Œæ˜¾ç¤ºè™šæ‹Ÿæ§åˆ¶å™¨å’Œæ¸¸æˆçŠ¶æ€
						if (isMobileDevice()) {
							document.getElementById('virtualControls').style.display = 'flex';
							document.getElementById('gameStatus').style.display = 'block';
							document.body.style.touchAction = 'manipulation';
							
							// é˜²æ­¢é¡µé¢æ»šåŠ¨
							document.body.style.overflow = 'hidden';
							document.documentElement.style.overflow = 'hidden';
							
							console.log('ç§»åŠ¨ç«¯é€‚é…å·²å¯ç”¨ - æ”¯æŒæ¨ªå±å’Œç«–å±');
							
							// å¯åŠ¨æ¸¸æˆçŠ¶æ€æ›´æ–°
							startGameStatusUpdates();
							
							// ç›‘å¬æ–¹å‘å˜åŒ–å¹¶è°ƒæ•´ç•Œé¢
							window.addEventListener('orientationchange', () => {
								setTimeout(() => {
									adjustUIForOrientation();
									if (window.BallGame && BallGame.resizeCanvas) {
										BallGame.resizeCanvas();
									}
								}, 300);
							});
							
							// åˆå§‹è°ƒæ•´
							adjustUIForOrientation();
						}
					}
				}, 100);
				
				// è¶…æ—¶ä¿æŠ¤
				setTimeout(() => {
					clearInterval(checkBallGame);
					if (!window.BallGame) {
						console.warn('BallGameå¯¹è±¡åˆå§‹åŒ–è¶…æ—¶ï¼Œå°è¯•åŸºç¡€ç§»åŠ¨ç«¯é€‚é…');
						if (isMobileDevice()) {
							document.getElementById('virtualControls').style.display = 'flex';
							document.getElementById('gameStatus').style.display = 'block';
						}
					}
				}, 5000);
			} catch (error) {
				console.error('æ¸¸æˆUIåˆå§‹åŒ–å¤±è´¥:', error);
			}
		}
		
		// æ ¹æ®æ–¹å‘è°ƒæ•´UI
		function adjustUIForOrientation() {
			const isPortrait = window.innerHeight > window.innerWidth;
			const virtualControls = document.getElementById('virtualControls');
			const gameStatus = document.getElementById('gameStatus');
			
			if (virtualControls) {
				// CSSå·²ç»å¤„ç†äº†å¤§éƒ¨åˆ†æ ·å¼ï¼Œè¿™é‡Œåªéœ€è¦ç¡®ä¿æ˜¾ç¤º
				virtualControls.style.display = 'flex';
			}
			
			if (gameStatus) {
				gameStatus.style.display = 'block';
			}
			
			// å¼ºåˆ¶é‡æ–°è°ƒæ•´ç”»å¸ƒå¤§å°ï¼Œç¡®ä¿å®Œæ•´æ˜¾ç¤º
			setTimeout(() => {
				if (window.BallGame && BallGame.resizeCanvas) {
					BallGame.resizeCanvas();
				}
				// é¢å¤–çš„ç”»å¸ƒè°ƒæ•´
				const canvas = document.querySelector('#container canvas');
				if (canvas) {
					const container = document.getElementById('container');
					if (container) {
						const containerRect = container.getBoundingClientRect();
						const aspectRatio = 960 / 600;
						
						let maxWidth, maxHeight;
						if (isPortrait) {
							maxWidth = containerRect.width * 0.85;
							maxHeight = containerRect.height * 0.45;
						} else {
							maxWidth = containerRect.width * 0.70;
							maxHeight = containerRect.height * 0.75;
						}
						
						// ç¡®ä¿æŒ‰æ¯”ä¾‹ç¼©æ”¾
						let finalWidth, finalHeight;
						if (maxWidth / maxHeight > aspectRatio) {
							finalHeight = maxHeight;
							finalWidth = finalHeight * aspectRatio;
						} else {
							finalWidth = maxWidth;
							finalHeight = finalWidth / aspectRatio;
						}
						
						canvas.style.width = finalWidth + 'px';
						canvas.style.height = finalHeight + 'px';
						canvas.style.maxWidth = finalWidth + 'px';
						canvas.style.maxHeight = finalHeight + 'px';
					}
				}
			}, 100);
			
			console.log(`ç•Œé¢å·²è°ƒæ•´ä¸º${isPortrait ? 'ç«–å±' : 'æ¨ªå±'}æ¨¡å¼ - ç¡®ä¿å®Œæ•´æ˜¾ç¤º`);
		}
		
		// æ¸¸æˆçŠ¶æ€æ›´æ–°
		function startGameStatusUpdates() {
			setInterval(() => {
				if (window.BallGame) {
					const scoreDisplay = document.getElementById('scoreDisplay');
					const ballsDisplay = document.getElementById('ballsDisplay');
					const gameState = document.getElementById('gameState');
					
					if (scoreDisplay && BallGame.player1) {
						scoreDisplay.textContent = BallGame.player1.score || 0;
					}
					
					if (ballsDisplay && BallGame.Ball && BallGame.Ball.balls) {
						ballsDisplay.textContent = BallGame.Ball.balls.length || 0;
					}
					
					if (gameState) {
						if (BallGame.paused) {
							gameState.textContent = 'å·²æš‚åœ';
						} else if (BallGame.canShot) {
							gameState.textContent = 'å‡†å¤‡å‡»çƒ';
						} else {
							gameState.textContent = 'çƒåœ¨ç§»åŠ¨';
						}
					}
				}
			}, 500);
		}
		
		// é¡µé¢åŠ è½½å®Œæˆåå¼€å§‹UIåˆå§‹åŒ–
		// æ³¨æ„ï¼šTaiqiu.jså·²ç»æœ‰è‡ªå·±çš„onloadäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨DOMContentLoadedç¡®ä¿ä¸ä¼šå†²çª
		document.addEventListener('DOMContentLoaded', function() {
			console.log('DOMå†…å®¹åŠ è½½å®Œæˆï¼Œå‡†å¤‡åˆå§‹åŒ–æ¸¸æˆUI');
			initGameUI();
		});
	</script>
</body>
</html>