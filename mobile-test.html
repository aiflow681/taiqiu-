<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <title>台球游戏移动端测试</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #f0f0f0;
        }
        .test-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-item {
            margin: 15px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-item h3 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .test-result {
            padding: 5px 10px;
            border-radius: 3px;
            font-weight: bold;
        }
        .pass { background: #d4edda; color: #155724; }
        .fail { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>台球游戏移动端兼容性测试</h1>
        
        <div class="test-item">
            <h3>设备检测</h3>
            <div id="deviceInfo" class="test-result info">检测中...</div>
        </div>
        
        <div class="test-item">
            <h3>屏幕方向</h3>
            <div id="orientationInfo" class="test-result info">检测中...</div>
        </div>
        
        <div class="test-item">
            <h3>触摸支持</h3>
            <div id="touchInfo" class="test-result info">检测中...</div>
        </div>
        
        <div class="test-item">
            <h3>视口尺寸</h3>
            <div id="viewportInfo" class="test-result info">检测中...</div>
        </div>
        
        <div class="test-item">
            <h3>Canvas支持</h3>
            <div id="canvasInfo" class="test-result info">检测中...</div>
        </div>
        
        <div class="test-item">
            <h3>操作测试</h3>
            <button class="btn" onclick="testTouch()">测试触摸响应</button>
            <button class="btn" onclick="testOrientation()">测试方向变化</button>
            <div id="operationResult" class="test-result info" style="margin-top: 10px;">等待测试...</div>
        </div>
        
        <div class="test-item">
            <h3>启动游戏</h3>
            <button class="btn" onclick="launchGame()" style="background: #28a745;">启动台球游戏</button>
            <p style="margin-top: 10px; font-size: 14px; color: #666;">
                建议在横屏模式下启动游戏以获得最佳体验
            </p>
        </div>
    </div>

    <script>
        // 设备检测
        function detectDevice() {
            const userAgent = navigator.userAgent;
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|Tablet/i.test(userAgent);
            const isTouch = 'ontouchstart' in window;
            const screenSize = window.innerWidth < 768;
            
            let deviceType = 'Desktop';
            if (isMobile || (isTouch && screenSize)) {
                deviceType = 'Mobile';
            }
            
            document.getElementById('deviceInfo').innerHTML = 
                `设备类型: ${deviceType}<br>` +
                `用户代理: ${userAgent.substring(0, 50)}...`;
            document.getElementById('deviceInfo').className = 
                `test-result ${deviceType === 'Mobile' ? 'pass' : 'info'}`;
        }
        
        // 屏幕方向检测
        function detectOrientation() {
            const orientation = window.innerHeight > window.innerWidth ? '竖屏' : '横屏';
            const angle = screen.orientation ? screen.orientation.angle : 'unknown';
            
            document.getElementById('orientationInfo').innerHTML = 
                `当前方向: ${orientation}<br>` +
                `屏幕角度: ${angle}°<br>` +
                `尺寸: ${window.innerWidth} x ${window.innerHeight}`;
            document.getElementById('orientationInfo').className = 
                `test-result ${orientation === '横屏' ? 'pass' : 'info'}`;
        }
        
        // 触摸支持检测
        function detectTouch() {
            const hasTouch = 'ontouchstart' in window;
            const maxTouchPoints = navigator.maxTouchPoints || 0;
            
            document.getElementById('touchInfo').innerHTML = 
                `触摸支持: ${hasTouch ? '是' : '否'}<br>` +
                `最大触摸点: ${maxTouchPoints}`;
            document.getElementById('touchInfo').className = 
                `test-result ${hasTouch ? 'pass' : 'fail'}`;
        }
        
        // 视口信息
        function detectViewport() {
            const viewport = {
                width: window.innerWidth,
                height: window.innerHeight,
                devicePixelRatio: window.devicePixelRatio || 1,
                screenWidth: screen.width,
                screenHeight: screen.height
            };
            
            document.getElementById('viewportInfo').innerHTML = 
                `视口: ${viewport.width} x ${viewport.height}<br>` +
                `屏幕: ${viewport.screenWidth} x ${viewport.screenHeight}<br>` +
                `像素比: ${viewport.devicePixelRatio}`;
            document.getElementById('viewportInfo').className = 'test-result info';
        }
        
        // Canvas支持检测
        function detectCanvas() {
            const canvas = document.createElement('canvas');
            const hasCanvas = !!(canvas.getContext && canvas.getContext('2d'));
            const hasWebGL = !!(canvas.getContext && canvas.getContext('webgl'));
            
            document.getElementById('canvasInfo').innerHTML = 
                `Canvas 2D: ${hasCanvas ? '支持' : '不支持'}<br>` +
                `WebGL: ${hasWebGL ? '支持' : '不支持'}`;
            document.getElementById('canvasInfo').className = 
                `test-result ${hasCanvas ? 'pass' : 'fail'}`;
        }
        
        // 触摸测试
        function testTouch() {
            let touchCount = 0;
            const resultDiv = document.getElementById('operationResult');
            
            resultDiv.innerHTML = '请在屏幕上点击或触摸...';
            resultDiv.className = 'test-result info';
            
            function handleTouch(e) {
                touchCount++;
                resultDiv.innerHTML = `触摸响应正常 (${touchCount} 次)`;
                resultDiv.className = 'test-result pass';
                
                if (touchCount >= 3) {
                    document.removeEventListener('touchstart', handleTouch);
                    document.removeEventListener('click', handleTouch);
                }
            }
            
            document.addEventListener('touchstart', handleTouch);
            document.addEventListener('click', handleTouch);
            
            setTimeout(() => {
                if (touchCount === 0) {
                    resultDiv.innerHTML = '触摸测试超时，可能存在兼容性问题';
                    resultDiv.className = 'test-result fail';
                }
                document.removeEventListener('touchstart', handleTouch);
                document.removeEventListener('click', handleTouch);
            }, 5000);
        }
        
        // 方向测试
        function testOrientation() {
            const resultDiv = document.getElementById('operationResult');
            resultDiv.innerHTML = '请旋转设备测试方向变化...';
            resultDiv.className = 'test-result info';
            
            let orientationChanges = 0;
            
            function handleOrientationChange() {
                orientationChanges++;
                const orientation = window.innerHeight > window.innerWidth ? '竖屏' : '横屏';
                resultDiv.innerHTML = `方向变化检测正常 (${orientationChanges} 次) - 当前: ${orientation}`;
                resultDiv.className = 'test-result pass';
            }
            
            window.addEventListener('orientationchange', handleOrientationChange);
            window.addEventListener('resize', handleOrientationChange);
            
            setTimeout(() => {
                window.removeEventListener('orientationchange', handleOrientationChange);
                window.removeEventListener('resize', handleOrientationChange);
                if (orientationChanges === 0) {
                    resultDiv.innerHTML = '未检测到方向变化，可能设备不支持或已锁定方向';
                    resultDiv.className = 'test-result info';
                }
            }, 10000);
        }
        
        // 启动游戏
        function launchGame() {
            window.location.href = 'index.html';
        }
        
        // 初始化检测
        function initTests() {
            detectDevice();
            detectOrientation();
            detectTouch();
            detectViewport();
            detectCanvas();
            
            // 监听方向变化
            window.addEventListener('orientationchange', () => {
                setTimeout(detectOrientation, 100);
            });
            window.addEventListener('resize', () => {
                setTimeout(() => {
                    detectOrientation();
                    detectViewport();
                }, 100);
            });
        }
        
        // 页面加载完成后开始检测
        document.addEventListener('DOMContentLoaded', initTests);
    </script>
</body>
</html>